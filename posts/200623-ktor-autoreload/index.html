<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Configuring Autoreload for Ktor | Danilo Herrera</title>
<meta name="keywords" content="ktor">
<meta name="description" content="In this post, we&rsquo;ll be going over how to create a basic Ktor project and configuring it with autoreload, a feature that automatically rebuilds the code on file changes. Furthermore, we&rsquo;ll explore two ways of building and running the application: via the command line and via the IDE.
Creating a Ktor project Using the latest version of IntelliJ IDEA, ensure the latest Ktor plugin is installed.
This plugin provides us with a convenient user interface to generate new Ktor projects.">
<meta name="author" content="Danilo Herrera">
<link rel="canonical" href="https://www.danherrera.dev/posts/200623-ktor-autoreload/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.1740750342264a4e69b84ddf6899fb02cc95465080d85c57c08bb1d110900bf6.css" integrity="sha256-F0B1A0ImSk5puE3faJn7AsyVRlCA2FxXwIux0RCQC/Y=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://www.danherrera.dev/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://www.danherrera.dev/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://www.danherrera.dev/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://www.danherrera.dev/apple-touch-icon.png">
<link rel="mask-icon" href="https://www.danherrera.dev/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8J3TMSHJNL"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-8J3TMSHJNL', { 'anonymize_ip': false });
}
</script>
<meta property="og:title" content="Configuring Autoreload for Ktor" />
<meta property="og:description" content="In this post, we&rsquo;ll be going over how to create a basic Ktor project and configuring it with autoreload, a feature that automatically rebuilds the code on file changes. Furthermore, we&rsquo;ll explore two ways of building and running the application: via the command line and via the IDE.
Creating a Ktor project Using the latest version of IntelliJ IDEA, ensure the latest Ktor plugin is installed.
This plugin provides us with a convenient user interface to generate new Ktor projects." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.danherrera.dev/posts/200623-ktor-autoreload/" />
<meta property="og:image" content="https://www.danherrera.dev/200623-ktor-autoreload.png" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-06-23T17:31:45-04:00" />
<meta property="article:modified_time" content="2020-06-23T17:31:45-04:00" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://www.danherrera.dev/200623-ktor-autoreload.png" />
<meta name="twitter:title" content="Configuring Autoreload for Ktor"/>
<meta name="twitter:description" content="In this post, we&rsquo;ll be going over how to create a basic Ktor project and configuring it with autoreload, a feature that automatically rebuilds the code on file changes. Furthermore, we&rsquo;ll explore two ways of building and running the application: via the command line and via the IDE.
Creating a Ktor project Using the latest version of IntelliJ IDEA, ensure the latest Ktor plugin is installed.
This plugin provides us with a convenient user interface to generate new Ktor projects."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://www.danherrera.dev/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Configuring Autoreload for Ktor",
      "item": "https://www.danherrera.dev/posts/200623-ktor-autoreload/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Configuring Autoreload for Ktor",
  "name": "Configuring Autoreload for Ktor",
  "description": "In this post, we\u0026rsquo;ll be going over how to create a basic Ktor project and configuring it with autoreload, a feature that automatically rebuilds the code on file changes. Furthermore, we\u0026rsquo;ll explore two ways of building and running the application: via the command line and via the IDE.\nCreating a Ktor project Using the latest version of IntelliJ IDEA, ensure the latest Ktor plugin is installed.\nThis plugin provides us with a convenient user interface to generate new Ktor projects.",
  "keywords": [
    "ktor"
  ],
  "articleBody": "In this post, we’ll be going over how to create a basic Ktor project and configuring it with autoreload, a feature that automatically rebuilds the code on file changes. Furthermore, we’ll explore two ways of building and running the application: via the command line and via the IDE.\nCreating a Ktor project Using the latest version of IntelliJ IDEA, ensure the latest Ktor plugin is installed.\nThis plugin provides us with a convenient user interface to generate new Ktor projects.\nSummon the New Project window by selecting the File \u003e New \u003e New Project… menu.\nTo get quickly started, click Next to start from a minimal Ktor project. Fill out the project’s Maven GroupId and ArtifactId:\nContinue to the next step to name the Gradle project:\nIn this example, the name is “MyFirstBasicKtorProject”. Remember this name to set up Ktor’s autoreload feature as this directory will be part of the Java classpath. After selecting Finish, open the Application.kt file:\nAs seen in this file, the main function is starting the Netty server engine. This engine references the application.conf HOCON configuration file under the resources directory:\nThis file defines the port that Ktor will use. This port can also be supplied via the PORT environment variable (in which case it will override the 8080 port defined above). Additionally, a module is predefined within the Application.kt file. Separate modules can be used to separate the definition of features.\nDefining a GET HTTP controller For starters, let’s define a basic GET controller that responds with plain text:\nThe Application class provides a routing block to define HTTP controllers. In this example, we are defining a root path GET controller. The get block provides a reference to the PipelineContext, which helps provide call, an object used to read the request and send a response. This instance utilizes the respondText function to respond with plain text. Although now we’re ready to run the application with the run gradle task, let’s first configure autoreload.\nConfiguring Autoreload Autoreload is a Ktor configuration feature that enables automatically rebuilding the project on file saves so that we don’t have to manually rebuild after changes. To enable this, we first must add the current classpath (correlates to the project’s directory name, e.g. MyFirstBasicKtorProject) to the ktor.deployment.watch HOCON configuration:\nBuilding and running via the command line If you prefer running the project via the command line, you can first run ./gradlew build -t in a terminal window. The -t flag defines a continuous build: as file changes happen, the build is re-triggered. Because the command is continuous, we will need a separate terminal window to run the next command: ./gradlew run. This will run the application.\nBuilding and running via IntelliJ IDEA From the top-right of the IDE, select Add Configuration…\nFrom the Run/Debug Configurations window, click the + button and select the Gradle option. Name the configuration (in this example, it is “Continuous Build”). Next, select the project from the folder icon drop down. For the Tasks option, type build. Additionally, supply the -t argument in order to configure this Gradle task as continuous. Click Apply to save the configuration.\nNext, we’ll create a run configuration by repeating the same steps to create a new configuration (via clicking the + button). Additionally, we will define the Continuous Build configuration as a dependency for the run configuration. To do so, click the + button under the Before launch section and select Run Another Configuration. Select Continuous Build from the drop down menu and select OK to complete setting up the configurations.\nPlay the Run configuration:\nBecause the Continuous Build is never-ending, the actual Run configuration does not run initially. To mitigate this, click on the Rerun icon.\nWe should now have both configurations running:\nViewing the running app in the browser In a browser, load http://localhost:8080/ to view the plain text we defined:\nIf we go back to the Application.kt file, make a change, and save the file…\n…then we will be able to refresh the browser and view the change without needing to manually rebuild the application!\nSummary To conclude, in this post we learned how to create a new Ktor project in IntelliJ IDEA. We learned how to:\nDefine a basic HTTP GET controller Configure the Ktor project for autoreload Continuously build and run a Ktor project from the command line Continuously build and run a Ktor project using the IDE Thank you for your time! To learn more about Ktor, please refer to the Ktor documentation.\nCheers!\n",
  "wordCount" : "749",
  "inLanguage": "en",
  "image":"https://www.danherrera.dev/200623-ktor-autoreload.png","datePublished": "2020-06-23T17:31:45-04:00",
  "dateModified": "2020-06-23T17:31:45-04:00",
  "author":{
    "@type": "Person",
    "name": "Danilo Herrera"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.danherrera.dev/posts/200623-ktor-autoreload/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Danilo Herrera",
    "logo": {
      "@type": "ImageObject",
      "url": "https://www.danherrera.dev/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://www.danherrera.dev/" accesskey="h" title="Danilo Herrera (Alt + H)">Danilo Herrera</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      Configuring Autoreload for Ktor
    </h1>
    <div class="post-meta"><span title='2020-06-23 17:31:45 -0400 EDT'>June 23, 2020</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;Danilo Herrera&nbsp;|&nbsp;<a href="https://github.com/danherrera/danherrera.dev-hugo/edit/main/content/posts/200623-ktor-autoreload/index.md" rel="noopener noreferrer" target="_blank">Edit</a>

</div>
  </header> 
<figure class="entry-cover">
        <img loading="lazy" srcset="https://www.danherrera.dev/posts/200623-ktor-autoreload/200623-ktor-autoreload_hu309b577c1e4493e63f0a5778b8239bef_15595_360x0_resize_box_3.png 360w ,https://www.danherrera.dev/posts/200623-ktor-autoreload/200623-ktor-autoreload_hu309b577c1e4493e63f0a5778b8239bef_15595_480x0_resize_box_3.png 480w ,https://www.danherrera.dev/posts/200623-ktor-autoreload/200623-ktor-autoreload.png 512w" 
            sizes="(min-width: 768px) 720px, 100vw" src="https://www.danherrera.dev/posts/200623-ktor-autoreload/200623-ktor-autoreload.png" alt="" 
            width="512" height="302">
        
</figure><div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#creating-a-ktor-project" aria-label="Creating a Ktor project">Creating a Ktor project</a></li>
                <li>
                    <a href="#defining-a-get-http-controller" aria-label="Defining a GET HTTP controller">Defining a GET HTTP controller</a></li>
                <li>
                    <a href="#configuring-autoreload" aria-label="Configuring Autoreload">Configuring Autoreload</a><ul>
                        
                <li>
                    <a href="#building-and-running-via-the-command-line" aria-label="Building and running via the command line">Building and running via the command line</a></li>
                <li>
                    <a href="#building-and-running-via-intellij-idea" aria-label="Building and running via IntelliJ IDEA">Building and running via IntelliJ IDEA</a></li></ul>
                </li>
                <li>
                    <a href="#viewing-the-running-app-in-the-browser" aria-label="Viewing the running app in the browser">Viewing the running app in the browser</a></li>
                <li>
                    <a href="#summary" aria-label="Summary">Summary</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p>In this post, we&rsquo;ll be going over how to create a basic Ktor project and configuring it with autoreload, a feature that automatically rebuilds the code on file changes. Furthermore, we&rsquo;ll explore two ways of building and running the application: via the command line and via the IDE.</p>
<h2 id="creating-a-ktor-project">Creating a Ktor project<a hidden class="anchor" aria-hidden="true" href="#creating-a-ktor-project">#</a></h2>
<p>Using the latest version of IntelliJ IDEA, ensure the latest Ktor plugin is installed.</p>
<p><img loading="lazy" src="200623-ktor-autoreload-1.png" alt="Image"  />
</p>
<p>This plugin provides us with a convenient user interface to generate new Ktor projects.</p>
<p>Summon the New Project window by selecting the <strong>File</strong> &gt; <strong>New</strong> &gt; <strong>New Project&hellip;</strong> menu.</p>
<p><img loading="lazy" src="200623-ktor-autoreload-2.png" alt="Image"  />
</p>
<p>To get quickly started, click Next to start from a minimal Ktor project. Fill out the project&rsquo;s Maven GroupId and ArtifactId:</p>
<p><img loading="lazy" src="200623-ktor-autoreload-3.png" alt="Image"  />
</p>
<p>Continue to the next step to name the Gradle project:</p>
<p><img loading="lazy" src="200623-ktor-autoreload-4.png" alt="Image"  />
</p>
<p>In this example, the name is &ldquo;MyFirstBasicKtorProject&rdquo;. Remember this name to set up Ktor&rsquo;s autoreload feature as this directory will be part of the Java classpath. After selecting Finish, open the <code>Application.kt</code> file:</p>
<p><img loading="lazy" src="200623-ktor-autoreload-5.png" alt="Image"  />
</p>
<p>As seen in this file, the main function is starting the Netty server engine. This engine references the <code>application.conf</code> HOCON configuration file under the <strong>resources</strong> directory:</p>
<p><img loading="lazy" src="200623-ktor-autoreload-6.png" alt="Image"  />
</p>
<p>This file defines the port that Ktor will use. This port can also be supplied via the <code>PORT</code> environment variable (in which case it will override the <code>8080</code> port defined above). Additionally, a module is predefined within the <code>Application.kt</code> file. Separate modules can be used to separate the definition of features.</p>
<h2 id="defining-a-get-http-controller">Defining a GET HTTP controller<a hidden class="anchor" aria-hidden="true" href="#defining-a-get-http-controller">#</a></h2>
<p>For starters, let&rsquo;s define a basic GET controller that responds with plain text:</p>
<p><img loading="lazy" src="200623-ktor-autoreload-7.png" alt="Image"  />
</p>
<p>The <code>Application</code> class provides a <code>routing</code> block to define HTTP controllers. In this example, we are defining a root path GET controller. The <code>get</code> block provides a reference to the <code>PipelineContext</code>, which helps provide <code>call</code>, an object used to read the request and send a response. This instance utilizes the <code>respondText</code> function to respond with plain text. Although now we&rsquo;re ready to run the application with the <code>run</code> gradle task, let&rsquo;s first configure autoreload.</p>
<h2 id="configuring-autoreload">Configuring Autoreload<a hidden class="anchor" aria-hidden="true" href="#configuring-autoreload">#</a></h2>
<p>Autoreload is a Ktor configuration feature that enables automatically rebuilding the project on file saves so that we don&rsquo;t have to manually rebuild after changes. To enable this, we first must add the current classpath (correlates to the project&rsquo;s directory name, e.g. <code>MyFirstBasicKtorProject</code>) to the <code>ktor.deployment.watch</code> HOCON configuration:</p>
<p><img loading="lazy" src="200623-ktor-autoreload-8.png" alt="Image"  />
</p>
<h3 id="building-and-running-via-the-command-line">Building and running via the command line<a hidden class="anchor" aria-hidden="true" href="#building-and-running-via-the-command-line">#</a></h3>
<p>If you prefer running the project via the command line, you can first run <code>./gradlew build -t</code> in a terminal window. The <code>-t</code> flag defines a continuous build: as file changes happen, the build is re-triggered. Because the command is continuous, we will need a separate terminal window to run the next command: <code>./gradlew run</code>. This will run the application.</p>
<p><img loading="lazy" src="200623-ktor-autoreload-9.png" alt="Image"  />
</p>
<p><img loading="lazy" src="200623-ktor-autoreload-10.png" alt="Image"  />
</p>
<h3 id="building-and-running-via-intellij-idea">Building and running via IntelliJ IDEA<a hidden class="anchor" aria-hidden="true" href="#building-and-running-via-intellij-idea">#</a></h3>
<p>From the top-right of the IDE, select <strong>Add Configuration&hellip;</strong></p>
<p><img loading="lazy" src="200623-ktor-autoreload-11.png" alt="Image"  />
</p>
<p>From the <strong>Run/Debug Configurations</strong> window, click the + button and select the <strong>Gradle</strong> option. Name the configuration (in this example, it is &ldquo;Continuous Build&rdquo;). Next, select the project from the folder icon drop down. For the Tasks option, type <code>build</code>. Additionally, supply the <code>-t</code> argument in order to configure this Gradle task as continuous. Click <strong>Apply</strong> to save the configuration.</p>
<p><img loading="lazy" src="200623-ktor-autoreload-12.png" alt="Image"  />
</p>
<p>Next, we&rsquo;ll create a run configuration by repeating the same steps to create a new configuration (via clicking the + button). Additionally, we will define the <strong>Continuous Build</strong> configuration as a dependency for the run configuration. To do so, click the <strong>+</strong> button under the <strong>Before launch</strong> section and select <strong>Run Another Configuration</strong>. Select <strong>Continuous Build</strong> from the drop down menu and select OK to complete setting up the configurations.</p>
<p><img loading="lazy" src="200623-ktor-autoreload-13.png" alt="Image"  />
</p>
<p>Play the <strong>Run</strong> configuration:</p>
<p><img loading="lazy" src="200623-ktor-autoreload-14.png" alt="Image"  />
</p>
<p>Because the <strong>Continuous Build</strong> is never-ending, the actual <strong>Run</strong> configuration does not run initially. To mitigate this, click on the Rerun icon.</p>
<p><img loading="lazy" src="200623-ktor-autoreload-15.png" alt="Image"  />
</p>
<p>We should now have both configurations running:</p>
<p><img loading="lazy" src="200623-ktor-autoreload-16.png" alt="Image"  />
</p>
<h2 id="viewing-the-running-app-in-the-browser">Viewing the running app in the browser<a hidden class="anchor" aria-hidden="true" href="#viewing-the-running-app-in-the-browser">#</a></h2>
<p>In a browser, load <code>http://localhost:8080/</code> to view the plain text we defined:</p>
<p><img loading="lazy" src="200623-ktor-autoreload-17.png" alt="Image"  />
</p>
<p>If we go back to the Application.kt file, make a change, and save the file&hellip;</p>
<p><img loading="lazy" src="200623-ktor-autoreload-18.png" alt="Image"  />
</p>
<p>&hellip;then we will be able to refresh the browser and view the change without needing to manually rebuild the application!</p>
<p><img loading="lazy" src="200623-ktor-autoreload-19.png" alt="Image"  />
</p>
<h2 id="summary">Summary<a hidden class="anchor" aria-hidden="true" href="#summary">#</a></h2>
<p>To conclude, in this post we learned how to create a new Ktor project in IntelliJ IDEA. We learned how to:</p>
<ul>
<li>Define a basic HTTP GET controller</li>
<li>Configure the Ktor project for autoreload</li>
<li>Continuously build and run a Ktor project from the command line</li>
<li>Continuously build and run a Ktor project using the IDE</li>
</ul>
<p>Thank you for your time! To learn more about Ktor, please refer to the <a href="https://ktor.io/servers/index.html">Ktor documentation</a>.</p>
<p>Cheers!</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://www.danherrera.dev/tags/ktor/">ktor</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="https://www.danherrera.dev/">Danilo Herrera</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
